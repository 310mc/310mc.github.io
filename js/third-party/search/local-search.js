document.addEventListener("DOMContentLoaded",()=>{if(CONFIG.path){const r=new LocalSearch({path:CONFIG.path,top_n_per_article:CONFIG.localsearch.top_n_per_article,unescape:CONFIG.localsearch.unescape}),a=document.querySelector(".search-input"),t=()=>{if(r.isfetched){const s=a.value.trim().toLowerCase();var t=s.split(/[-\s]+/);const c=document.querySelector(".search-result-container");let e=[];0<s.length&&(e=r.getResultItems(t)),1===t.length&&""===t[0]?(c.classList.add("no-result"),c.innerHTML='<div class="search-result-icon"><i class="fa fa-search fa-5x"></i></div>'):0===e.length?(c.classList.add("no-result"),c.innerHTML='<div class="search-result-icon"><i class="far fa-frown fa-5x"></i></div>'):(e.sort((e,t)=>e.includedCount!==t.includedCount?t.includedCount-e.includedCount:e.hitCount!==t.hitCount?t.hitCount-e.hitCount:t.id-e.id),t=CONFIG.i18n.hits.replace(/\$\{hits}/,e.length),c.classList.remove("no-result"),c.innerHTML=`<div class="search-stats">${t}</div>
        <hr>
        <ul class="search-result-list">${e.map(e=>e.item).join("")}</ul>`,"object"==typeof pjax&&pjax.refresh(c))}};r.highlightSearchWords(document.querySelector(".post-body")),CONFIG.localsearch.preload&&r.fetchData(),"auto"===CONFIG.localsearch.trigger?a.addEventListener("input",t):(document.querySelector(".search-icon").addEventListener("click",t),a.addEventListener("keypress",e=>{"Enter"===e.key&&t()})),window.addEventListener("search:loaded",t),document.querySelectorAll(".popup-trigger").forEach(e=>{e.addEventListener("click",()=>{document.body.classList.add("search-active"),setTimeout(()=>a.focus(),500),r.isfetched||r.fetchData()})});const s=()=>{document.body.classList.remove("search-active")};document.querySelector(".search-pop-overlay").addEventListener("click",e=>{e.target===document.querySelector(".search-pop-overlay")&&s()}),document.querySelector(".popup-btn-close").addEventListener("click",s),document.addEventListener("pjax:success",()=>{r.highlightSearchWords(document.querySelector(".post-body")),s()}),window.addEventListener("keyup",e=>{"Escape"===e.key&&s()})}else console.warn("`hexo-generator-searchdb` plugin is not installed!")});